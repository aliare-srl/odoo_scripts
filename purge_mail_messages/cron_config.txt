# Crontab usuario postgres
# Editar con: sudo crontab -eu postgres
# IMPORTANTE: Ajustar la ruta absoluta al directorio de scripts y programas.

# Obligatorio establecer BD_A_PURGAR
BD_A_PURGAR=full24
# Opcionales, con sus valores predeterminados
# FECHA_CORTE=2025-07-01
# BATCH_SIZE=50000
# LOCK_TIMEOUT=60s

# 1. Configura PostgreSQL para el borrado (2:58 AM)
58 2 * * * /home/admin/odoo_script/purge_mail_messages/setup.sh 2>&1 | logger -t PURGAR_MAIL_MESSAGE

# 2. Ejecuta purga cada 5 min entre 3:00-5:55 AM
*/5 3-5 * * * /usr/bin/flock -n /tmp/purgar_mail_message.flock /usr/bin/time /home/admin/odoo_script/purge_mail_messages/purgar_mail_message.sh 2>&1 | logger -t PURGAR_MAIL_MESSAGE

# 3. Restaura configuraciÃ³n (6:02 AM)
2 6 * * * /home/admin/odoo_script/purge_mail_messages/reset.sh 2>&1 | logger -t PURGAR_MAIL_MESSAGE

